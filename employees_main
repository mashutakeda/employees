{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "02cfb8a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import xlwings as xw\n",
    "wb = xw.Book(r'Employees.xlsm')\n",
    "MySht = wb.sheets['Part1']\n",
    "\n",
    "lst = MySht.range('A2:A41')\n",
    "count = 0\n",
    "allTheLists = [[] for x in range(10)]\n",
    "\n",
    "for eachRow in lst.rows:\n",
    "    for cell in eachRow.columns:\n",
    "        if re.match('[A-Z]*\\d\\w+', cell.value):\n",
    "            count = count + 1\n",
    "            allTheLists[count-1].append(cell.value)\n",
    "        else:\n",
    "            allTheLists[count-1].append(cell.value)\n",
    "            \n",
    "count = 0\n",
    "for x in allTheLists:\n",
    "    while len(x) < 6:\n",
    "        x.append(None)\n",
    "    \n",
    "MySht.range('E2').value = allTheLists"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "id": "c7a5303e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import xlwings as xw\n",
    "wb = xw.Book(r'Employees.xlsm')\n",
    "MySht = wb.sheets['Part2']\n",
    "\n",
    "Emp = MySht.range('A2:A41')\n",
    "Pos = MySht.range('B2:B41')\n",
    "\n",
    "omitJunior = 0\n",
    "\n",
    "count = 0\n",
    "count2 = 0\n",
    "count3 = 0\n",
    "for eachRow2 in Emp.rows:\n",
    "    for cell2 in eachRow2.columns:\n",
    "        if re.match('[A-Z]*\\d\\w+', cell2.value):\n",
    "            count3 = count3 + 1\n",
    "    \n",
    "allTheLists = [[] for x in range(count3)]\n",
    "\n",
    "for eachRow in Emp.rows:\n",
    "    for cell in eachRow.columns:\n",
    "        withb = cell.expand('right').address\n",
    "        bB = re.findall('\\$B.*', withb)\n",
    "        for x in bB:\n",
    "            if 'Junior' in Pos.value[count2] and omitJunior == 0:\n",
    "                continue\n",
    "            else:\n",
    "                if re.match('[A-Z]*\\d\\w+', cell.value):\n",
    "                    count = count + 1\n",
    "                    allTheLists[count-1].append(cell.value)\n",
    "                else:\n",
    "                    allTheLists[count-1].append(cell.value)\n",
    "    count2 = count2 + 1\n",
    "\n",
    "count = 0\n",
    "for x in allTheLists:\n",
    "    while len(x) < 6:\n",
    "        x.append(None)\n",
    "    \n",
    "MySht.range('E2').value = allTheLists"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ece02447",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import xlwings as xw\n",
    "\n",
    "@xw.func\n",
    "@xw.arg('unstackedEmpData', xw.Range, ndim=1)\n",
    "@xw.arg('position', xw.Range, ndim=1)\n",
    "@xw.arg('omitJunior', xw.Range)\n",
    "\n",
    "def UNSTACK_EMP(unstackedEmpData, position, omitJunior=[]):\n",
    "    count = 0\n",
    "    count2 = 0\n",
    "    count3 = 0\n",
    "    \n",
    "    for eachRow2 in unstackedEmpData.rows:\n",
    "        for cell2 in eachRow2.columns:\n",
    "            if re.match('[A-Z]*\\d\\w+', cell2.value):\n",
    "                count3 = count3 + 1\n",
    "    \n",
    "    allTheLists = [[] for x in range(count3)]\n",
    "    \n",
    "    if len(unstackedEmpData) != len(position):    \n",
    "        return 'Error'\n",
    "    \n",
    "    if omitJunior == []:\n",
    "        omitJunior = 0\n",
    "    else:\n",
    "        omitJunior = 1    \n",
    "    \n",
    "    for eachRow in unstackedEmpData.rows:\n",
    "        for cell in eachRow.columns:\n",
    "            withb = cell.expand('right').address\n",
    "            bB = re.findall('\\$B.*', withb)\n",
    "            for x in bB:\n",
    "                if 'Junior' in position.value[count2] and omitJunior == 0:\n",
    "                    continue\n",
    "                else:\n",
    "                    if re.match('[A-Z]*\\d\\w+', cell.value):\n",
    "                        count = count + 1\n",
    "                        allTheLists[count-1].append(cell.value)\n",
    "                    else:\n",
    "                        allTheLists[count-1].append(cell.value)\n",
    "        count2 = count2 + 1\n",
    "                \n",
    "    for x in allTheLists:\n",
    "        while len(x) < 6:\n",
    "            x.append(None)\n",
    "    \n",
    "    \n",
    "    \n",
    "    return allTheLists"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
